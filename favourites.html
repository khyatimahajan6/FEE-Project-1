<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favourites</title>
    <link rel="icon" href="feastifylogo.png" type="image/x-icon">
    <link rel="stylesheet" href="index.html">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="bootstrap.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
    <script src="cart.js" defer></script>
    <style>
        header {
            margin-top: -70px;
        }

        body {
            font-family: "Poppins", sans-serif;
        }

        #favourites-section {
            padding: 20px;
            background-color: #fefefe;
            border-top: 1px solid #ddd;
            margin-top: 70px;
        }

        #favourites-section h2 {
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #333;
        }

        #favourites-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        /* Individual Favourite Item */
        .favourite-item {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            width: 250px;
            overflow: hidden;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .favourite-item:hover {
            transform: translateY(-5px);
            box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
        }

        .favourite-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-bottom: 1px solid #ddd;
        }

        .favourite-item h3 {
            font-size: 1.2em;
            margin: 10px 0;
            color: #444;
        }

        .favourite-item p {
            font-size: 1em;
            color: #777;
            margin: 10px 0;
        }

        /* Remove Button Styling */
        .remove-from-favourites {
            display: inline-block;
            background-color: #ff6b6b;
            color: #ffffff;
            border: none;
            padding: 10px 15px;
            font-size: 0.9em;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            transition: background-color 0.3s ease;
        }

        .remove-from-favourites:hover {
            background-color: #ff4d4d;
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <img src="feastifylogo.png" alt="logo">
            <h1>Feastify</h1>
        </div>
        <input type="checkbox" id="menu-toggle" class="menu-toggle">
        <label for="menu-toggle" class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </label>

        <nav>
            <ul>
                <input type="text" id="searchInput" placeholder="Search in Favourites...">
                <label for="searchInput">
                    <i class="fa-solid fa-magnifying-glass fa-lg" style="color: #ffffff; padding-top: 16px;"></i>
                </label>

                <script>
                    document.getElementById('searchInput').addEventListener('input', function () {
                        const filter = this.value.toLowerCase(); // Get the search input and convert to lowercase
                        const favouriteItems = document.querySelectorAll('.favourites-section .box, .favourites-section .offer-item, .favourites-section .card'); // Select items in the Favourites section

                        favouriteItems.forEach(item => {
                            const itemName = item.getAttribute('data-name').toLowerCase(); // Get the item name
                            if (itemName.includes(filter)) {
                                item.style.display = 'block'; // Show the item if it matches the filter
                            } else {
                                item.style.display = 'none'; // Hide the item if it doesn't match
                            }
                        });
                    });
                </script>

                <li><a href="index.html"><span class="material-symbols-outlined">home</span> Home</a></li>
                <li><a href="menu.html"><span class="material-symbols-outlined">menu_book</span> Menu</a></li>
                <li><a href="cart.html"><span class="material-symbols-outlined">shopping_cart</span>Cart(<span
                            id="cart-count">0</span>)</a></li>
                <li><a href="favourites.html">Favourites</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a data-bs-toggle="offcanvas" href="#offcanvas2" role="button" aria-controls="offcanvasExample"><svg
                            class="ppAwf" viewBox="6 -1 12 25" height="19" width="19" fill="white">
                            <path
                                d="M21.966903,13.2244898 C22.0156989,12.8231523 22.0408163,12.4145094 22.0408163,12 C22.0408163,11.8357822 22.036874,11.6724851 22.029079,11.5101984 L17.8574333,11.5102041 C17.8707569,11.6717062 17.877551,11.8350597 17.877551,12 C17.877551,12.4199029 17.8335181,12.8295214 17.749818,13.2244898 L21.966903,13.2244898 Z M21.5255943,15.1836735 L16.9414724,15.1836735 C15.8950289,16.8045422 14.0728218,17.877551 12,17.877551 C9.92717823,17.877551 8.1049711,16.8045422 7.05852762,15.1836735 L2.47440565,15.1836735 C3.80564362,19.168549 7.56739481,22.0408163 12,22.0408163 C16.4326052,22.0408163 20.1943564,19.168549 21.5255943,15.1836735 Z M21.7400381,9.55102041 C20.6468384,5.18931674 16.7006382,1.95918367 12,1.95918367 C7.2993618,1.95918367 3.3531616,5.18931674 2.25996187,9.55102041 L6.6553883,9.55102041 C7.58404845,7.5276442 9.62792376,6.12244898 12,6.12244898 C14.3720762,6.12244898 16.4159515,7.5276442 17.3446117,9.55102041 L21.7400381,9.55102041 Z M2.03309705,13.2244898 L6.25018203,13.2244898 C6.16648186,12.8295214 6.12244898,12.4199029 6.12244898,12 C6.12244898,11.8350597 6.1292431,11.6717062 6.14256675,11.5102041 L1.97092075,11.5102041 C1.96312595,11.6724851 1.95918367,11.8357822 1.95918367,12 C1.95918367,12.4145094 1.98430112,12.8231523 2.03309705,13.2244898 Z M12,24 C5.372583,24 0,18.627417 0,12 C0,5.372583 5.372583,0 12,0 C18.627417,0 24,5.372583 24,12 C24,18.627417 18.627417,24 12,24 Z M12,15.9183673 C14.1640545,15.9183673 15.9183673,14.1640545 15.9183673,12 C15.9183673,9.83594547 14.1640545,8.08163265 12,8.08163265 C9.83594547,8.08163265 8.08163265,9.83594547 8.08163265,12 C8.08163265,14.1640545 9.83594547,15.9183673 12,15.9183673 Z">
                            </path>
                        </svg> Contact Us</a></li>
                <li id="user-menu"><a data-bs-toggle="offcanvas" href="#offcanvas1" role="button"
                        aria-controls="offcanvasExample" id="logout-link"><span
                            class="material-symbols-outlined">person</span>
                        <span id="user-name">Sign In</span></a></li>
                <script>
                    function updateNavbar() {
                        const userMenu = document.getElementById("user-menu");
                        const userNameElement = document.getElementById("user-name");
                        const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

                        if (loggedInUser) {
                            // Replace "Sign In" with the user's name
                            userNameElement.textContent = loggedInUser.Name;

                            // Optionally, add a dropdown for account options (e.g., logout)
                            userMenu.innerHTML = `
                                          <a href="#" id="logout-link">
                                              <span class="material-symbols-outlined">person</span> 
                                              ${loggedInUser.Name}
                                          </a>
                                      `;

                            // Add logout functionality
                            const logoutLink = document.getElementById("logout-link");
                            logoutLink.addEventListener("click", function () {
                                localStorage.removeItem("loggedInUser"); // Clear logged-in user data
                                alert("You have logged out.");
                                location.reload(); // Reload page to reset navbar
                            });
                        }
                    }

                    // Call the function on page load
                    window.onload = function () {
                        updateNavbar();
                    };
                </script>
            </ul>
        </nav>
    </header>

    <section id="favourites-section">
        <h2>Your Favourites</h2>
        <div id="favourites-container">
            <!-- Favourited items will be displayed here -->
        </div>
    </section>

    <script>
        // Initialize favourites array from localStorage (if any)
        let favourites = JSON.parse(localStorage.getItem("favourites")) || [];

        // Event listener for "Add to Favourites" buttons
        document.querySelectorAll(".add-to-favourites").forEach((button) => {
            button.addEventListener("click", function () {
                const menuItem = this.closest(".box, .offer-item, .card"); // Find the parent menu item
                const itemId = menuItem.getAttribute("data-id");
                const itemName = menuItem.getAttribute("data-name");
                const itemPrice = menuItem.getAttribute("data-price");
                const itemImage = menuItem.querySelector("img").getAttribute("src"); // Get image URL

                // Check if item is already in favourites
                const isFavourite = favourites.some((item) => item.id === itemId);
                if (!isFavourite) {
                    // Add item to favourites array
                    favourites.push({ id: itemId, name: itemName, price: itemPrice, image: itemImage });

                    // Save updated favourites array to localStorage
                    localStorage.setItem("favourites", JSON.stringify(favourites));

                    // Change the heart icon to filled (❤️) to show it's added to favourites
                    this.innerHTML = '<i class="fa fa-heart" style="color: red;"></i>';

                    // Optionally, show a confirmation message
                    alert(`${itemName} added to favourites!`);
                } else {
                    alert("This item is already in your favourites!");
                }
            });
        });

        // Initialize all hearts with an empty state (❤️ or ♥)
        document.querySelectorAll(".add-to-favourites").forEach((button) => {
            const menuItem = button.closest(".offer-item");
            const itemId = menuItem.getAttribute("data-id");

            // Check if item is already in favourites
            if (favourites.some((item) => item.id === itemId)) {
                button.innerHTML = '<i class="fa fa-heart" style="color: red;"></i>'; // Filled heart
            } else {
                button.innerHTML = '<i class="fa fa-heart"></i>'; // Empty heart
            }
        });

        // Display Favourited Items (Optional: In case you want a separate section for favourites)
        function displayFavourites() {
            const favouritesContainer = document.getElementById("favourites-container");
            favouritesContainer.innerHTML = ""; // Clear the existing favourites

            favourites.forEach((item) => {
                const favouriteItem = document.createElement("div");
                favouriteItem.classList.add("favourite-item");
                favouriteItem.innerHTML = `
            <img src="${item.image}" alt="${item.name}" class="favourite-image" />
            <h3>${item.name}</h3>
            <p>₹${item.price}</p>
            <button class="remove-from-favourites" data-id="${item.id}">Remove from Favourites</button>
        `;
                favouritesContainer.appendChild(favouriteItem);
            });

            // Add event listeners for remove buttons
            document.querySelectorAll(".remove-from-favourites").forEach((button) => {
                button.addEventListener("click", function () {
                    const itemId = this.getAttribute("data-id");
                    favourites = favourites.filter((item) => item.id !== itemId); // Remove item from favourites
                    localStorage.setItem("favourites", JSON.stringify(favourites)); // Update localStorage
                    displayFavourites(); // Re-render favourites
                });
            });
        }

        // Call displayFavourites() when the page loads to show favourites
        displayFavourites();

    </script>
</body>

</html>